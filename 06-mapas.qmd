---
title: "Mapas Interativos"
---

```{r}
library(leaflet)

#source("scripts/load_cached_data.R")
```

Caso os dados de localização estejam no objeto `localizacao`, geramos mapa interativo dos sensores.

```{r}
if (exists("localizacao")) {

    df_map <- localizacao %>%
    dplyr::mutate(popup = paste0("<b>", Local, "</b><br/>Cidade: ", Cidade,
                          "<br/>Tipo: ", Tipo))
  pal <- colorFactor(RColorBrewer::brewer.pal(5,"Set2"), df_map$Cidade)

  leaflet(df_map) %>%
    addTiles() %>%
    addCircleMarkers(~Long, ~Lat,
                     color=~pal(Cidade),
                     radius=6,
                     stroke=TRUE, weight=1,
                     fillOpacity=0.8,
                     popup=~popup) %>%
    leaflet::addLegend("bottomright", pal=pal, values=~Cidade, title="Cidade")
}
```
